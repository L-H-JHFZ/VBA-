# 编写你的第一个 VBA 宏

## 步骤 1 [创建启用宏的工作簿](./saveWorkbookContainVBACode.md)

首先新建一个工作簿，并将工作簿保存为「启用宏的工作簿」类型。

## 步骤 2 [打开 VBA 编辑器](./excelVBADevelopmentUsingVBAEditor.md)

通过功能区「开发工具 → 代码 → Visual Basic」或快捷键 Alt + F11 打开 VBA 编辑器。

## 步骤 3 插入一个新模块

Excel 工作簿中的 VBA 代码通常保存在工作表对象或模块中。

首先选中左侧工程列表中的工作簿，后右键，在弹出的选项列表中，选择「插入」。二级菜单中，选择「模块」，完成插入新模块。

插入完成后，在工程列表对应工作簿内，在模块文件夹下，显示新插入的模块。新插入的模块的默认名称是，模块x，本例中是模块1。在属性窗口，可以修改模块的名称。

## 步骤 4 打开模块

双击上一步插入的模块1，在右侧代码窗口区域里，将打开模块1的代码编辑器。在右侧代码窗口中当前打开的代码编辑器所对应的模块。

## 步骤 5 创建一个宏（VBA 过程）

在代码编辑窗口中，输入以下代码：
```vba
Sub MyCode()
    
End Sub
```
这段代码是一个空的 VBA 过程，只有开始和结束。过程的其他代码，都在这中间编写。

其中 Sub 是 Subroutine 的缩写，直译过来是子程序。在 VBA 中表示一个过程，也是代表一个过程的开始。下一行 End Sub 表示过程的结束。

## 步骤 6 编写 VBA 过程实体部分

过程的实体部分指的是，真正会被执行的部分。上一步创建的是一个空的 VBA 过程，里面不包含实体代码。虽然可以正常运行，但是不会有结果输出。

这一步我们编写 VBA 过程的实体部分。将如下代码输入到过程的开始和结束处之间。
```vba
MsgBox "Hello World"
```

## 步骤 7 运行代码

现在我们已经写完了一个完整的 VBA 过程，现在运行它，看一下结果。

将光标放置在代码的任何一处，点击工具栏上的运行「▶ 」按钮，或按 F5，运行代码。

可以看到运行结果，Excel 弹出一个对话框，显示内容正是在代码中编写的内容。

## 总结
本篇教程介绍了如何从零开始编写 VBA 过程，基本步骤如下：

1. 插入模块
2. 创建空过程
3. 编写过程的实体
4. 运行过程