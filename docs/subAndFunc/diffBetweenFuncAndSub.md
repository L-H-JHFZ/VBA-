# VBA 函数与过程的不同点

* [声明语句不同](#声明语句不同)
* [函数可以返回值](#函数可以返回值)
* [函数需指定返回值类型](#函数需指定返回值类型)
* [函数主体代码中，返回值赋值到函数自己](#函数主体代码中返回值赋值到函数自己)
* [调用函数时，使用类型与函数返回值类型相同的变量获得返回值](#调用函数时使用类型与函数返回值类型相同的变量获得返回值)
* [函数可在单元格内公式中使用](#函数可在单元格内公式中使用)
* [总结](#总结)

## 声明语句不同

函数的声明语句是 `Function` 和 `End Function`，而过程的声明语句是 `Sub` 和 `End Sub`。

下面的代码是函数声明代码：
```vba
Function MyFunc()
    
End Function
```
下面的代码是子过程声明代码：
```vba
Sub SayHello()
    
End Sub
``` 

## 函数可以返回值

函数相对子过程最大的不同点是，函数可以返回指定的值。调用函数时，使用一个变量存储函数返回的值，可以在后续的代码中使用。

这里需要指出的是，函数可以不返回值，这种情况其作用与子过程相同。因此建议，不需要返回值时，直接使用子过程代替函数。

## 函数需指定返回值类型

在《VBA 变量、类型和运算符》一章中讲到，VBA 中数据有多种类型，准确使用数据类型可以是程序效率更高。

同样，函数声明时也需要指定其返回值的类型。其语法与变量声明类似，在函数名后指定数据类型。
```vba
Function MyFunc() As String '指定返回值类型，此函数将返回文本类型的值
    
End Function
``` 

## <a name="函数主体代码中返回值赋值到函数自己">函数主体代码中，返回值赋值到函数自己</a>

函数返回一个值，是通过在函数主体代码中，将返回的值赋值到函数自己的方法来实现。
```vba
Function MyFunc() As String
    '此函数将返回 Hello World 的文本
    MyFunc = "Hello World"
End Function
``` 

## <a name="调用函数时使用类型与函数返回值类型相同的变量获得返回值">调用函数时，使用类型与函数返回值类型相同的变量获得返回值</a>

当主程序中调用函数获取其值时，需要使用类型与函数返回值类型相同的变量，否则程序会出错。
```vba
Sub MyCode()
    
    Dim text As String '声明与函数返回值相同类型的变量
    text = MyFunc '调用函数，获得其返回的值
    Range("A1") = text '使用函数返回的值
    
End Sub

'此函数被上面的过程调用
Function MyFunc() As String
    '此函数将返回 Hello World 的文本
    MyFunc = "Hello World"
End Function
``` 

## 函数可在单元格内公式中使用

与 Excel 内置的函数一样，用户自定义编写的函数可在公式中直接使用，其用法与内置函数一样。

自定义函数也一样可以嵌套使用。

## 总结

函数与过程最大的不同是，函数可以返回值，本篇教程在此基础上，总结了函数与子过程的 6 个不同点。根据函数和子过程的不同特性，实际代码中混合使用两者，可以提高开发效率，也有助于更好地组织代码。



