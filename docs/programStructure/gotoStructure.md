# VBA GoTo 结构

VBA 中，在程序运行时，使用 GoTo 结构，跳转到指定标签处运行，从而不执行 GoTo 语句和指定标签之间的代码。

> 在实际的 VBA 开发中，Goto 结构多用于处理错误的情形，即发生错误时，跳转到处理错误的代码处。

* [语法](#语法)
* [实例](#实例)
* [总结](#总结)

## 语法

`GoTo` 结构由 `GoTo` 语句和`标签语句`组成。基本语法如下：
```vba
GoTo [标签]
'被跳过的代码
...
[标签]:
'被执行的代码
```
跳转的位置由 `Goto` 关键词后的 [标签] 告诉程序，VBA 会在代码中查找对应的 [标签]: 关键词，从标签下一行继续执行程序。

需要注意的是，跳转处的标签，后接`冒号 ( : )` 。

## 实例

下面的例子说明 GoTo 结构的基本用法。使用 VBA 作除法，如果除数是零，则跳转到程序末尾，提示除数不符合规范。
```vba
Sub MyCode()

    Dim num1 As Double
    Dim num2 As Double
    Dim result As Double
    
    num1 = 100
    num2 = 0
    
    If num2 = 0 Then GoTo error
    
    result = num1 / num2
    
    Exit Sub
    
error:
    MsgBox "除数不能为零"

End Sub
```
可以看到，例子中 num2 是除数，程序判断 num2 是否为零，如果是，则跳转到 Error 标签处，除法部分不会被执行。

## 总结

Goto 结构相对简单，实际开发中不像三大结构使用频繁，但是在一些情形中使用，可以使代码更简洁易读。GoTo 语句常用于错误处理外，还可以用在「上一步/下一步」类情形中，根据用户需求，重复执行同一个步骤。


